version: 1
workflow:
  - stage: bootstrap
    tasks:
      - id: clone
        description: "Use the GitHub template to create a new repository"
      - id: setup
        description: "Run ./scripts/setup.sh to create the virtualenv and install hooks"
  - stage: development
    tasks:
      - id: lint
        description: "Run pre-commit run --all-files"
      - id: test
        description: "Run pytest"
      - id: boundaries
        description: "Ensure shared services use gabriel/common interfaces"
      - id: preview
        description: "Serve the WebGL viewer locally with gabriel viewer"
      - id: docs
        description: "Build MkDocs docs with make docs before publishing"
      - id: secrets-boundary
        description: "Review docs/gabriel/SECRET_BOUNDARY.md before touching relay or storage code"
  - stage: release
    tasks:
      - id: merge
        description: "Merge to main and let Release Drafter generate notes"
